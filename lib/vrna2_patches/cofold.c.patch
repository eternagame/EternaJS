13c13
< #include <config.h>
---
> #include "config.h"
113a114,117
> /* TSC - 5/14/18 -- defined in fold.c */
> int E_IntLoopNew(int n1, int n2, int type, int type_2, int si1, int sj1, int sp1, int sq1,
>                  int index_i, int index_p, int index_j, int index_q, paramT* P);
> 
229a234,250
> /// NNFIX
> float cofold_with_binding_site(const char *string, char *structure, int i, int p, int j, int q, int bonus) {
>   binding_site_i = i;
>   binding_site_j = j;
>   binding_site_p = p;
>   binding_site_q = q;
>   binding_site_bonus = bonus;
>           
>   float e = cofold(string,structure);
>   binding_site_i = -1;
>   binding_site_j = -1;
>   binding_site_p = -1;
>   binding_site_q = -1;
>   binding_site_bonus = NULL;
>   return e;
> }
> 
406c427
<               energy = E_IntLoop(p-i-1, j-q-1, type, type_2, si, sj, S1[p-1], S1[q+1], P);
---
>               energy = E_IntLoopNew(p-i-1, j-q-1, type, type_2, si, sj, S1[p-1], S1[q+1], i, p, j, q, P);
1040,1041c1061,1062
<           energy = E_IntLoop(p-i-1, j-q-1, type, type_2,
<                               S1[i+1], S1[j-1], S1[p-1], S1[q+1], P);
---
>           energy = E_IntLoopNew(p-i-1, j-q-1, type, type_2,
>                               S1[i+1], S1[j-1], S1[p-1], S1[q+1], i, p, j, q, P);
1237c1258
<     asm("nop");
---
>     /*asm("nop")*/;
